<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN" "http://www.springframework.org/dtd/spring-beans.dtd">

<beans>

  <!-- 
    Adding a security interceptor for GeoXACML    
  -->
			
	<bean id="filterInvocationInterceptor"
    class="org.geoserver.xacml.acegi.XACMLFilterSecurityInterceptor">
    <property name="authenticationManager" ref="authenticationManager" />
        <property name="accessDecisionManager">
      <bean class="org.geoserver.xacml.acegi.XACMLFilterAccessDecisionManager">
        <property name="allowIfAllAbstainDecisions" value="false" />
        <property name="decisionVoters">
          <list>
            <bean class="org.geoserver.xacml.acegi.XACMLFilterDecisionVoter" />
          </list>
        </property>
      </bean>
    </property>    
  </bean> 
	
	
	
	  
   <!-- XACMLHttpTransportFactory -->
   <!-- using a remote PDP, first param is remote URL, second if multithreaded (recommended)
     
  <bean id="xacmlHttpTransportFactory" class="org.geotools.xacml.transport.XACMLHttpTransportFactory">     
    <constructor-arg index="0" value="http://localhost:8080/geoserver/security/geoxacml"/>
    <constructor-arg index="1" value="true"/> 
  </bean>
   -->
   
  <bean id="userDetailsService" class="org.geoserver.xacml.security.XACMLGeoserverUserDao">
    <property name="geoServer" ref="geoServer" />
  </bean>
    
</beans>
