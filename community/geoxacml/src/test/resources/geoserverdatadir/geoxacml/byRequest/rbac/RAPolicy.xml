<?xml version="1.0" encoding="UTF-8"?>
<Policy xmlns="urn:oasis:names:tc:xacml:2.0:policy:schema:os"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="urn:oasis:names:tc:xacml:2.0:policy:schema:os http://docs.oasis-open.org/xacml/2.0/access_control-xacml-2.0-policy-schema-os.xsd"
  PolicyId="Role:Assignment:Policy"
  RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides">

<Target>
		<Subjects>
			<Subject>
				<SubjectMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
					<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Alice0</AttributeValue>
					<SubjectAttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id"
						DataType="http://www.w3.org/2001/XMLSchema#string" />
				</SubjectMatch>
			</Subject>
		</Subjects>

</Target>

<!-- Employee role requirements rule -->
<Rule RuleId="employee:role:requirements" Effect="Permit">
	<Target>
		<Subjects>
			<Subject>
				<SubjectMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
					<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Alice0</AttributeValue>
					<SubjectAttributeDesignator
						AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" DataType="http://www.w3.org/2001/XMLSchema#string" />
				</SubjectMatch>
			</Subject>
			<Subject>
				<SubjectMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
					<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Alice2</AttributeValue>
					<SubjectAttributeDesignator
						AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" DataType="http://www.w3.org/2001/XMLSchema#string" />
				</SubjectMatch>
			</Subject>
		</Subjects>
		<Resources>
			<Resource>                  
				<ResourceMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:anyURI-equal">
					<AttributeValue 
					    DataType="http://www.w3.org/2001/XMLSchema#anyURI">urn:example:role-values:employee</AttributeValue>
					<ResourceAttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role:"
						DataType="http://www.w3.org/2001/XMLSchema#anyURI" />
				</ResourceMatch>
			</Resource>
		</Resources>
		<Actions>
			<Action>
				<ActionMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:anyURI-equal">
					<AttributeValue 
					DataType="http://www.w3.org/2001/XMLSchema#anyURI">urn:oasis:names:tc:xacml:2.0:actions:enableRole</AttributeValue>
					<ActionAttributeDesignator
						AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" DataType="http://www.w3.org/2001/XMLSchema#anyURI" />
				</ActionMatch>
			</Action>
		</Actions>
	</Target>
	<Condition>
		<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:and">
			<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:time-greater-than-or-equal">
				<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:time-one-and-only">
					<EnvironmentAttributeDesignator
						AttributeId="urn:oasis:names:tc:xacml:1.0:environment:current-time" DataType="http://www.w3.org/2001/XMLSchema#time" />
				</Apply>
				<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#time">09:00:00</AttributeValue>
			</Apply>
			<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:time-less-than-or-equal">
				<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:time-one-and-only">
					<EnvironmentAttributeDesignator
						AttributeId="urn:oasis:names:tc:xacml:1.0:environment:current-time" DataType="http://www.w3.org/2001/XMLSchema#time" />
				</Apply>
				<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#time">17:00:00</AttributeValue>
			</Apply>
		</Apply>
	</Condition>
</Rule>



<!-- Manager role requirements rule -->
<Rule RuleId="manager:role:requirements" Effect="Permit">
	<Target>
		<Subjects>
			<Subject>
				<SubjectMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
					<AttributeValue 
						DataType="http://www.w3.org/2001/XMLSchema#string">Bob</AttributeValue>
					<SubjectAttributeDesignator
						AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" DataType="http://www.w3.org/2001/XMLSchema#string" />
				</SubjectMatch>
			</Subject>
		</Subjects>
		<Resources>
			<Resource>
				<ResourceMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:anyURI-equal">
					<AttributeValue 
					DataType="http://www.w3.org/2001/XMLSchema#anyURI">urn:example:role-values:manager</AttributeValue>
					<ResourceAttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role:"
						DataType="http://www.w3.org/2001/XMLSchema#anyURI" />
				</ResourceMatch>
			</Resource>
		</Resources>
		<Actions>
			<Action>
				<ActionMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:anyURI-equal">
					<AttributeValue 
					   DataType="http://www.w3.org/2001/XMLSchema#anyURI">urn:oasis:names:tc:xacml:2.0:actions:enableRole</AttributeValue>
					<ActionAttributeDesignator
						AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" DataType="http://www.w3.org/2001/XMLSchema#anyURI" />
				</ActionMatch>
			</Action>
		</Actions>
	</Target>
</Rule>
</Policy>